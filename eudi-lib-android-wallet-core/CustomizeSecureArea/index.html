
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://eu-digital-identity-wallet.github.io/eudi-lib-android-wallet-core/CustomizeSecureArea/">
      
      
      
      
      <link rel="icon" href="../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>CustomizeSecureArea - EUDI Wallet Dev Hub</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#use-wallet-core-library-with-custom-key-management" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="EUDI Wallet Dev Hub" class="md-header__button md-logo" aria-label="EUDI Wallet Dev Hub" data-md-component="logo">
      
  <img src="../../assets/logo_eudi_white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EUDI Wallet Dev Hub
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CustomizeSecureArea
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Build/" class="md-tabs__link">
          
  
    
  
  Build

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Test/" class="md-tabs__link">
          
  
    
  
  Test

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Resources/" class="md-tabs__link">
          
  
    
  
  Resources

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="EUDI Wallet Dev Hub" class="md-nav__button md-logo" aria-label="EUDI Wallet Dev Hub" data-md-component="logo">
      
  <img src="../../assets/logo_eudi_white.svg" alt="logo">

    </a>
    EUDI Wallet Dev Hub
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Build/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Build
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Build
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Build/Build%20your%20Wallet/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Build your Wallet
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Build your Wallet
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Android
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            Android
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_2_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Build/Build%20your%20Wallet/Android/Wallet%20Application%20Level/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Wallet Application Level
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2_2_1" id="__nav_2_2_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            Wallet Application Level
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Build/Build%20your%20Wallet/Android/Wallet%20Application%20Level/Running%20with%20Remote%20Services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run with Remote Services
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Build/Build%20your%20Wallet/Android/Wallet%20Application%20Level/Running%20with%20Local%20Services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run with Local Services
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Build/Build%20your%20Wallet/Android/Wallet%20Application%20Level/Self-signed%20Certificates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Self-signed Certificates
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Build/Build%20your%20Wallet/Android/Library%20Level/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Library Level
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2_2_2" id="__nav_2_2_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            Library Level
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Build/Build%20your%20Wallet/Android/Library%20Level/Build%20the%20Core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build the Core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Build/Build%20your%20Wallet/Android/Library%20Level/Manage%20Documents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manage Documents
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_3" id="__nav_2_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    iOS
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            iOS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_3_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Build/Build%20your%20Wallet/iOS/Wallet%20Application%20Level/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Wallet Application Level
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2_3_1" id="__nav_2_2_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3_1">
            <span class="md-nav__icon md-icon"></span>
            Wallet Application Level
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Build/Build%20your%20Wallet/iOS/Wallet%20Application%20Level/Running%20with%20Remote%20Services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run with Remote Services
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Build/Build%20your%20Wallet/iOS/Wallet%20Application%20Level/Running%20with%20Local%20Services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run with Local Services
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Build/Build%20your%20Wallet/iOS/Wallet%20Application%20Level/Self-signed%20Certificates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Self-signed Certificates
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Build/Build%20your%20Wallet/iOS/Library%20Level/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Library Level
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2_3_2" id="__nav_2_2_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3_2">
            <span class="md-nav__icon md-icon"></span>
            Library Level
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Build/Build%20your%20Wallet/iOS/Library%20Level/Build%20the%20Kit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build the Kit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Build/Build%20your%20Wallet/iOS/Library%20Level/Manage%20Documents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manage Documents
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Build/Build%20your%20Issuer/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Build your Issuer
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Build your Issuer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Build/Build%20your%20Issuer/Steps%20to%20Build/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Steps to Build
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Build/Build%20your%20Issuer/Configure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure your Issuer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Build/Build%20your%20Issuer/New%20Attestation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Add Attestations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Build/Build%20your%20Verifier/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Build your Verifier
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Build your Verifier
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Build/Build%20your%20Verifier/Steps%20to%20Build/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Steps to Build
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Build/Build%20your%20Verifier/Configure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure your Verifier
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Test/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Test
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Test/Wallet%20Application/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Wallet Application
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Wallet Application
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Test/Wallet%20Application/Android/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Android
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Test/Wallet%20Application/iOS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    iOS
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Test/Issuer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Issuer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Test/Online%20Verifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Online Verifier
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Test/Proximity%20Verifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Proximity Verifier
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Resources/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Resources
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#interfaces-and-classes-for-custom-key-management" class="md-nav__link">
    <span class="md-ellipsis">
      Interfaces and classes for custom key management
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-eudiwallet-with-custom-key-management" class="md-nav__link">
    <span class="md-ellipsis">
      Using EudiWallet with custom key management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using EudiWallet with custom key management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configure-eudiwallet-to-use-custom-key-management" class="md-nav__link">
    <span class="md-ellipsis">
      Configure EudiWallet to use custom key management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-use-custom-key-management-with-openid4vci" class="md-nav__link">
    <span class="md-ellipsis">
      How to use custom key management with OpenId4VCI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-use-custom-key-management-with-presentation" class="md-nav__link">
    <span class="md-ellipsis">
      How to use custom key management with Presentation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<p><a href="/">Home</a></p>
<h1 id="use-wallet-core-library-with-custom-key-management">Use wallet core library with custom Key management</h1>
<p>The Wallet Core Library supports custom key management through the implementation of SecureArea
interfaces. This document details the process of integrating custom key management with the library.</p>
<h2 id="interfaces-and-classes-for-custom-key-management">Interfaces and classes for custom key management</h2>
<p>To enable custom key management, you must implement the following interfaces and classes:</p>
<ol>
<li>The <code>com.android.identity.securearea.SecureArea</code> interface abstracts the underlying secure area
   responsible for creating key material and other security-related objects used in identity
   documents. Authentication may be required to access a key, which is managed through the
   <code>com.android.identity.securearea.KeyLockedException</code> and
   <code>com.android.identity.securearea.KeyUnlockData</code> types. Applications must implement
   SecureArea-specific mechanisms to handle the necessary authentication.</li>
<li>The <code>com.android.identity.securearea.CreateKeySettings</code> class serves as the base for key creation
   settings. It is compatible with any SecureArea implementation, though most implementations will
   provide their own versions with additional, specific settings.</li>
<li>The <code>com.android.identity.securearea.KeyUnlockData</code> interface provides the information necessary
   to operate on a key that requires unlocking.</li>
<li>The <code>com.android.identity.securearea.KeyInfo</code> class contains details about a key. Specific
   SecureArea implementations may extend this class to include additional implementation-specific
   key information.</li>
</ol>
<h2 id="using-eudiwallet-with-custom-key-management">Using EudiWallet with custom key management</h2>
<p>Using a custom SecureArea implementation involves focusing on three key areas:</p>
<ol>
<li>Configuring the wallet instance to integrate the custom SecureArea implementation.</li>
<li>Managing events during the issuance of documents with OpenId4VCI, where key creation and
   unlocking are necessary.</li>
<li>Managing events during document presentation with OpenId4VP or proximity presentation via BLE,
   where key unlocking is needed.</li>
</ol>
<p>For the purposes of this document and the examples provided, we will refer to the following custom
SecureArea implementations:</p>
<ol>
<li><code>MySecureArea</code> class implementing the <code>SecureArea</code> interface.</li>
<li><code>MyCreateKeySettings</code> class extending the <code>CreateKeySettings</code> class.</li>
<li><code>MyKeyUnlockData</code> class implementing the <code>KeyUnlockData</code> interface.</li>
<li><code>MyKeyInfo</code> class extending the <code>KeyInfo</code> class.</li>
</ol>
<h3 id="configure-eudiwallet-to-use-custom-key-management">Configure EudiWallet to use custom key management</h3>
<p>To register the <code>MySecureArea</code> implementation with the Wallet Core Library, you must configure the
wallet instance as shown below:</p>
<div class="highlight"><pre><span></span><code><span class="kd">val</span><span class="w"> </span><span class="nv">walletConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EudiWalletConfig</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="na">configureOpenId4Vci</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Configuration for OpenId4VCI</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="p">.</span><span class="na">configureOpenId4Vp</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Configuration for OpenId4VP</span>
<span class="w">    </span><span class="p">}</span>
<span class="kd">val</span><span class="w"> </span><span class="nv">wallet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EudiWallet</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">walletConfig</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">withSecureAreas</span><span class="p">(</span>
<span class="w">        </span><span class="n">listOf</span><span class="p">(</span>
<span class="w">            </span><span class="n">MySecureArea</span><span class="p">()</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>For detailed information on EudiWallet configuration, please refer to
the <a href="https://github.com/eu-digital-identity-wallet/eudi-lib-android-wallet-core?tab=readme-ov-file#initialize-the-library">EudiWallet documentation</a></p>
<p><em>Note</em>:If the <code>MySecureArea</code> instance is required, it can be retrieved from the wallet instance
using the following code:</p>
<div class="highlight"><pre><span></span><code><span class="kd">val</span><span class="w"> </span><span class="nv">mySecureArea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wallet</span><span class="p">.</span><span class="na">secureAreaRepository</span><span class="p">.</span><span class="na">implementations</span>
<span class="w">    </span><span class="p">.</span><span class="na">filterIsInstance</span><span class="o">&lt;</span><span class="n">MySecureArea</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="na">first</span><span class="p">()</span>
</code></pre></div>
<h3 id="how-to-use-custom-key-management-with-openid4vci">How to use custom key management with OpenId4VCI</h3>
<p>When issuing a document with OpenId4VCI, the Wallet Core Library triggers events that require custom
key management. There are two key events that necessitate this:</p>
<ol>
<li>
<p><strong><code>IssueEvent.DocumentRequiresCreateSettings</code></strong>: This event occurs when creating a document for a
   specific offered document that requires a key. In the case of custom key management, you must
   create the corresponding <code>CreateDocumentSettings</code> object to accompany the <code>SecureArea</code>
   implementation. This object defines in which <code>SecureArea</code> and how the key should be created.
   The <code>createDocumentSettings</code> is then used to resume the issuance process.</p>
</li>
<li>
<p><strong><code>IssueEvent.DocumentRequiresUserAuth</code></strong>: This event is triggered when key unlocking is needed
   to sign the proof of possession for the document's key, which is required to issue the document.
   To unlock the key, you must create the appropriate <code>KeyUnlockData</code> object that corresponds to the
   <code>SecureArea</code> implementation. This object specifies how the key should be unlocked (e.g., via
   password, biometric data, or authorization tokens). The <code>keyUnlockData</code> is then used to resume
   the issuance process.</p>
</li>
</ol>
<p>The following code snippet demonstrates how to handle these events with custom key management using
the custom <code>MySecureArea</code> implementation:</p>
<div class="highlight"><pre><span></span><code><span class="kd">val</span><span class="w"> </span><span class="nv">onIssueEvent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OnIssueEvent</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">event</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">is</span><span class="w"> </span><span class="n">IssueEvent</span><span class="p">.</span><span class="na">DocumentRequiresCreateSettings</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// triggered when creating a document for a given offered document</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">offeredDocument</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">event</span><span class="p">.</span><span class="na">offeredDocument</span>
<span class="w">            </span><span class="c1">// create the createDocumentSettings for the document</span>
<span class="w">            </span><span class="c1">// using custom implementation MySecureArea for keys</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">mySecureArea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wallet</span><span class="p">.</span><span class="na">secureAreaRepository</span><span class="p">.</span><span class="na">implementations</span>
<span class="w">                </span><span class="p">.</span><span class="na">filterIsInstance</span><span class="o">&lt;</span><span class="n">MySecureArea</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">first</span><span class="p">()</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">createDocumentSettings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateDocumentSettings</span><span class="p">(</span>
<span class="w">                </span><span class="c1">// set the identifier of the desired secure area</span>
<span class="w">                </span><span class="n">secureAreaIdentifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mySecureArea</span><span class="p">.</span><span class="na">identifier</span><span class="p">,</span>
<span class="w">                </span><span class="c1">// set the CreateKeySettings for the key based on the secure area</span>
<span class="w">                </span><span class="n">createKeySettings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MyCreateKeySettings</span><span class="p">(</span>
<span class="w">                    </span><span class="c1">// set custom settings for creating the key</span>
<span class="w">                    </span><span class="c1">// with MySecureArea implementation</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">            </span><span class="c1">// resume the issuance process with the createDocumentSettings</span>
<span class="w">            </span><span class="n">event</span><span class="p">.</span><span class="na">resume</span><span class="p">(</span><span class="n">createDocumentSettings</span><span class="p">)</span>
<span class="w">            </span><span class="c1">// or cancel the issuance process</span>
<span class="w">            </span><span class="n">event</span><span class="p">.</span><span class="na">cancel</span><span class="p">(</span><span class="s">&quot;User canceled the issuance process&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">is</span><span class="w"> </span><span class="n">IssueEvent</span><span class="p">.</span><span class="na">DocumentRequiresUserAuth</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// triggered when user authentication is required to issue a document</span>
<span class="w">            </span><span class="c1">// Holds the document object that requires user authentication</span>
<span class="w">            </span><span class="c1">// and the algorithm that is going to be used for signing the proof of possession,</span>
<span class="w">            </span><span class="c1">// as well as methods for resuming the issuance process or canceling it</span>

<span class="w">            </span><span class="c1">// Document and signing algorithm are provided </span>
<span class="w">            </span><span class="c1">// to use if required for creating the keyUnlockData</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">signingAlgorithm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">event</span><span class="p">.</span><span class="na">signingAlgorithm</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">document</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">event</span><span class="p">.</span><span class="na">document</span>

<span class="w">            </span><span class="c1">//</span>
<span class="w">            </span><span class="c1">// --&gt; show prompt if needed to unlock the key &lt;--</span>
<span class="w">            </span><span class="c1">//</span>

<span class="w">            </span><span class="c1">// create the keyUnlockData to unlock the key.</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">keyUnlockData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MyKeyUnlockData</span><span class="p">(</span>
<span class="w">                </span><span class="c1">// set the extra information for the key unlock data</span>
<span class="w">                </span><span class="c1">// e.g. password, biometric data, authorization tokens etc.</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">            </span><span class="c1">// to resume the issuance process, after authenticating user,  call</span>
<span class="w">            </span><span class="c1">// resume with the keyUnlockData</span>
<span class="w">            </span><span class="n">event</span><span class="p">.</span><span class="na">resume</span><span class="p">(</span><span class="n">keyUnlockData</span><span class="p">)</span>

<span class="w">            </span><span class="c1">// or cancel the issuance process by calling cancel method</span>
<span class="w">            </span><span class="n">event</span><span class="p">.</span><span class="na">cancel</span><span class="p">(</span><span class="s">&quot;User canceled the issuance process&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// handling rest of issuing events</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="how-to-use-custom-key-management-with-presentation">How to use custom key management with Presentation</h3>
<p>When presenting a document using OpenId4VP or through proximity presentation with BLE, a
<code>TransferEvent.RequestReceived</code> event is triggered upon receiving a request. The request contains
the documents and items to be disclosed. To disclose the requested documents, you must unlock the
keys associated with those documents. To do this, you need to create the appropriate <code>KeyUnlockData</code>
object, which corresponds to the <code>SecureArea</code> implementation. This object specifies how the key
should be unlocked (e.g., using a password, biometric data, authorization tokens, etc.). The
<code>keyUnlockData</code> is then used to generate the response.</p>
<p>The following code snippet illustrates how to handle the <code>TransferEvent.RequestReceived</code> event and
disclose the requested documents with custom key management using a custom <code>SecureArea</code>
implementation when key unlocking is required:</p>
<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * Keeps the processed request to be used later for generating the response</span>
<span class="cm"> */</span>
<span class="kd">lateinit</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nv">processedRequest</span><span class="p">:</span><span class="w"> </span><span class="n">RequestProcessor</span><span class="p">.</span><span class="na">ProcessedRequest</span><span class="p">.</span><span class="na">Success</span>

<span class="cm">/**</span>
<span class="cm"> * Example function that demonstrates how to get information about the requested documents</span>
<span class="cm"> * and show them to the user. The function should be called when the request is received.</span>
<span class="cm"> */</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">showRequestedDocuments</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// shows requested documents to user</span>

<span class="w">    </span><span class="n">processedRequest</span><span class="p">.</span><span class="na">requestedDocuments</span><span class="p">.</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">requestedDocument</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="c1">// get document if needed to show more information such as document&#39;s name and docType</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">document</span><span class="w"> </span><span class="o">=</span>
<span class="w">            </span><span class="n">wallet</span><span class="p">.</span><span class="na">getDocumentById</span><span class="p">(</span><span class="n">requestedDocument</span><span class="p">.</span><span class="na">documentId</span><span class="p">)</span><span class="w"> </span><span class="k">as?</span><span class="w"> </span><span class="n">IssuedDocument</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">documentName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="o">?.</span><span class="na">name</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">docType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">document</span><span class="o">?.</span><span class="na">format</span><span class="w"> </span><span class="k">as?</span><span class="w"> </span><span class="n">MsoMdocFormat</span><span class="p">)</span><span class="o">?.</span><span class="na">docType</span>

<span class="w">        </span><span class="c1">// show requested fields for this document</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">docItems</span><span class="w"> </span><span class="o">=</span>
<span class="w">            </span><span class="n">requestedDocument</span><span class="p">.</span><span class="na">requestedItems</span><span class="p">.</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">(</span><span class="n">docItem</span><span class="p">,</span><span class="w"> </span><span class="n">intentToRetain</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="kd">val</span><span class="w"> </span><span class="nv">nameSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">docItem</span><span class="p">.</span><span class="na">namespace</span>
<span class="w">                </span><span class="kd">val</span><span class="w"> </span><span class="nv">elementIdentifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">docItem</span><span class="p">.</span><span class="na">elementIdentifier</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Example function that demonstrates how to generate and send a response based on the</span>
<span class="cm"> * selected documents. The function should be called after the user has selected the</span>
<span class="cm"> * documents to disclose.</span>
<span class="cm"> *</span>
<span class="cm"> * @param selectedDocuments A map of selected documents and the selected items to disclose</span>
<span class="cm"> */</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">discloseDocuments</span><span class="p">(</span><span class="n">selectedDocuments</span><span class="p">:</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">IssuedDocument</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">DocItem</span><span class="o">&gt;&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">disclosedDocuments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DisclosedDocuments</span><span class="p">(</span>
<span class="w">        </span><span class="n">selectedDocuments</span><span class="p">.</span><span class="na">map</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">(</span><span class="n">document</span><span class="p">,</span><span class="w"> </span><span class="n">docItems</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span>

<span class="w">            </span><span class="c1">// should block until the user has unlock the key to sign the response</span>

<span class="w">            </span><span class="c1">// One can use information from document to determine how to</span>
<span class="w">            </span><span class="c1">// create the MyKeyUnlockData object, such as:</span>

<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">secureArea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="p">.</span><span class="na">secureArea</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">MySecureArea</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">keyAlias</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="p">.</span><span class="na">keyAlias</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">keyInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="p">.</span><span class="na">keyInfo</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">MyKeyInfo</span>

<span class="w">            </span><span class="c1">//</span>
<span class="w">            </span><span class="c1">// --&gt; show prompt if needed to unlock the key &lt;--</span>
<span class="w">            </span><span class="c1">//</span>

<span class="w">            </span><span class="c1">// create and return the keyUnlockData to unlock the key of the document</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">keyUnlockData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MyKeyUnlockData</span><span class="p">(</span>
<span class="w">                </span><span class="c1">// set the extra information for the key unlock data</span>
<span class="w">                </span><span class="c1">// e.g. password, biometric data, authorization tokens etc.</span>
<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="n">DisclosedDocument</span><span class="p">(</span>
<span class="w">                </span><span class="n">documentId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="p">.</span><span class="na">id</span><span class="p">,</span>
<span class="w">                </span><span class="n">disclosedItems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">docItems</span><span class="p">,</span>
<span class="w">                </span><span class="n">keyUnlockData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">keyUnlockData</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">})</span>

<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">processedRequest</span><span class="p">.</span><span class="na">generateResponse</span><span class="p">(</span><span class="n">disclosedDocuments</span><span class="p">).</span><span class="na">getOrThrow</span><span class="p">()</span>
<span class="w">    </span><span class="n">wallet</span><span class="p">.</span><span class="na">sendResponse</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Example transfer event listener that demonstrates how to handle the request received event</span>
<span class="cm"> * and show the requested documents to the user.</span>
<span class="cm"> */</span>
<span class="kd">val</span><span class="w"> </span><span class="nv">transferEventListener</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TransferEvent</span><span class="p">.</span><span class="na">Listener</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">event</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="k">is</span><span class="w"> </span><span class="n">TransferEvent</span><span class="p">.</span><span class="na">RequestReceived</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// get the processed request</span>
<span class="w">            </span><span class="n">processedRequest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">event</span><span class="p">.</span><span class="na">processedRequest</span><span class="p">.</span><span class="na">getOrThrow</span><span class="p">()</span>
<span class="w">            </span><span class="c1">// the request has been received and processed</span>

<span class="w">            </span><span class="n">showRequestedDocuments</span><span class="p">()</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Throwable</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// An error occurred</span>
<span class="w">            </span><span class="c1">// handle the error</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="c1">// handle other events</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Add the transfer event listener to the wallet</span>
<span class="n">wallet</span><span class="p">.</span><span class="na">addTransferEventListener</span><span class="p">(</span><span class="n">transferEventListener</span><span class="p">)</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            




  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.highlight", "search.suggest", "navigation.expand", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.footer", "navigation.instant", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>